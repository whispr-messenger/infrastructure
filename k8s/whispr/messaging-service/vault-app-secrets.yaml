---
# VaultStaticSecret syncs messaging-service-specific secrets from Vault KV
# Provides: SECRET_KEY_BASE, ENCRYPTION_KEY
# (generated by vault-bootstrap-job on first run)
apiVersion: secrets.hashicorp.com/v1beta1
kind: VaultStaticSecret
metadata:
  name: messaging-service-app-secrets
  namespace: whispr-prod
spec:
  vaultAuthRef: messaging-service-vault-auth
  mount: kv
  type: kv-v2
  path: whispr/messaging-service/secrets
  destination:
    name: messaging-service-app-secret
    create: true
  rolloutRestartTargets:
    - kind: Deployment
      name: messaging-service
  refreshAfter: 1h
